<!DOCTYPE html>
<html>
<head>
    <title>{{pageTitle}}</title>
    <link rel="stylesheet" href="/css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    <div class="header">
        <img class="logo" src="/images/calendar.jpg" alt="Calendar">
        <h1>{{pageTitle}}</h1>
    </div>

    <div class="layout">

        <div class="left">
            <h2>Appointments</h2>

            <form method="GET" action="/" class="searchRow">
                <input type="hidden" name="filter" value="{{currentFilter}}">
                <input type="hidden" name="sort" value="{{currentSort}}">
                <input name="q" placeholder="Search title" value="{{currentQ}}">
                <button type="submit">Search</button>
            </form>

            <div class="linkRow">
                <a href="{{filterAllUrl}}">All</a>
                <a href="{{filterUpcomingUrl}}">Upcoming</a>
                <a href="{{filterPastUrl}}">Past</a>
            </div>

            <div class="linkRow">
                <a href="{{sortDateUrl}}">Date</a>
                <a href="{{sortTitleUrl}}">Title</a>
                <a href="{{sortStatusUrl}}">Status</a>
            </div>

            <ul class="apptList">

                {{#appointments}}
                <li class="apptItem">
                    <div class="apptTop">
                        <div class="apptTitle">
                            <a href="/appointments/{{id}}?filter={{currentFilter}}&sort={{currentSort}}&q={{currentQ}}">
                                {{title}}
                            </a>
                        </div>
                        <div class="apptBadge">{{status}}</div>
                    </div>

                    <div class="apptMeta">
                        {{date}} {{start_time}} to {{end_time}}
                    </div>

                    <div class="apptMeta">
                        {{location_name}}
                    </div>

                    <div class="apptActions">
                        <a class="actionLink" href="/appointments/{{id}}/edit?filter={{currentFilter}}&sort={{currentSort}}&q={{currentQ}}">Edit</a>

                        <form method="POST" action="/appointments/{{id}}/delete" class="inlineForm">
                            <button type="submit">Delete</button>
                        </form>
                    </div>
                </li>
                {{/appointments}}

                {{^appointments}}
                <li class="emptyState">No appointments match.</li>
                {{/appointments}}

            </ul>
        </div>

        <div class="right">

            <h2>Details</h2>

            {{#selected}}
                <p><strong>Title</strong> {{title}}</p>
                <p><strong>Description</strong> {{description}}</p>
                <p><strong>Date</strong> {{date}}</p>
                <p><strong>Time</strong> {{start_time}} to {{end_time}}</p>
                <p><strong>Location</strong> {{location_name}}</p>
                <p><strong>Status</strong> {{status}}</p>
            {{/selected}}

            {{^selected}}
                <p>Select an appointment to view details.</p>
            {{/selected}}

            <hr>

            {{#editMode}}
            <h2>Edit Appointment</h2>
            {{/editMode}}
            {{^editMode}}
            <h2>Add Appointment</h2>
            {{/editMode}}

            {{#errors}}
            <div class="errorBox">
                Please fix the form errors below.
            </div>
            {{/errors}}

            {{#editMode}}
            <form method="POST" action="/appointments/{{editId}}/update" class="apptForm">
            {{/editMode}}
            {{^editMode}}
            <form method="POST" action="/appointments" class="apptForm">
            {{/editMode}}

                <label>Title</label>
                <input name="title" value="{{form.title}}">
                <div class="errorText">{{errors.title}}</div>

                <label>Description</label>
                <input name="description" value="{{form.description}}">

                <label>Date</label>
                <input name="date" placeholder="YYYY-MM-DD" value="{{form.date}}">
                <div class="errorText">{{errors.date}}</div>

                <label>Start Time</label>
                <input name="start_time" placeholder="HH:MM" value="{{form.start_time}}">
                <div class="errorText">{{errors.start_time}}</div>

                <label>End Time</label>
                <input name="end_time" placeholder="HH:MM" value="{{form.end_time}}">
                <div class="errorText">{{errors.end_time}}</div>
                <div class="errorText">{{errors.time}}</div>

                <label>Location Name</label>
                <input name="location_name" value="{{form.location_name}}">

                <label>Address</label>
                <input name="location_address" value="{{form.location_address}}">

                <label>Latitude</label>
                <input name="latitude" value="{{form.latitude}}">
                <div class="errorText">{{errors.latitude}}</div>

                <label>Longitude</label>
                <input name="longitude" value="{{form.longitude}}">
                <div class="errorText">{{errors.longitude}}</div>
                <div class="errorText">{{errors.coords}}</div>

                <label>Status</label>
                <select name="status">
                    <option value="Upcoming" {{#form.formStatusUpcoming}}selected{{/form.formStatusUpcoming}}>Upcoming</option>
                    <option value="Past" {{#form.formStatusPast}}selected{{/form.formStatusPast}}>Past</option>
                </select>

                {{#editMode}}
                <div class="formButtons">
                    <button type="submit">Save</button>
                    <a class="actionLink" href="/?filter={{currentFilter}}&sort={{currentSort}}&q={{currentQ}}">Cancel</a>
                </div>
                {{/editMode}}

                {{^editMode}}
                <div class="formButtons">
                    <button type="submit">Create</button>
                </div>
                {{/editMode}}

            </form>

        </div>
    </div>

</body>
</html>